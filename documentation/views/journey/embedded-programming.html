<div class="data-journey"><span class="glyphicon glyphicon-calendar"></span><div>week 8</div>19/03 - 26/03, 2014</div><div class="content-header"><h1>Embedded Programming</h1><p class="lead">Read a microcontroller <a href="http://academy.cba.mit.edu/classes/embedded_programming/doc8183.pdf" target="_blank">data sheet</a><br>Program your <a href="http://academy.cba.mit.edu/classes/electronics_design/index.html" target="_blank">board</a> to do something, with as many different programming languages and programming environments as possible</p><p><strong>Class web page:</strong> <a href="http://academy.cba.mit.edu/classes/embedded_programming/index.html" target="_blank">http://academy.cba.mit.edu/classes/embedded_programming/index.html</a><br></p></div><!-- Keep all page content within the page-content inset div! --><div class="page-content no-padding"><p>For this week I use Fab ISP programmer and my <a href="http://fabacademy.org/archives/2014/students/arrata.leonardo/journey/electronics-design">re-designed "hello board"</a> and I will program the ATtiny44A and the RGB led and the buttom with the <a href="http://arduino.cc/es/main/software" target="_blank">Arduino IDE</a> and <a href="http://highlowtech.org/?p=1695" target="_blank">Arduino Bootloader.</a></p><!-- ATiny reading Data Sheet --><section><h2>Software</h2><p>To allow our micro crontrollers be programmed we need to have all these software installed. Make sure your <a href="https://github.com/damellis/attiny/archive/master.zip" target="_blank">FTDI drivers are installed.</a></p><ol><li>Arduino IDE Software: <a href="http://arduino.cc/es/main/software" target="_blank">http://arduino.cc/es/main/software</a></li><li>Arduino ATtiny hardware Library: <a href="https://github.com/damellis/attiny/archive/master.zip" target="_blank">https://github.com/damellis/attiny/archive/master.zip</a></li><li>FTDI Drivers:<a href="http://www.ftdichip.com/FTDrivers.htm" target="_blank">http://www.ftdichip.com/FTDrivers.htm</a></li></ol><h4>Installation</h4><p>After downloading all the software you need to install Arduino IDE and FTDI Drivers first following the wizard steps. I am using Mac OS, so it is simple to configure than an Windows OS. If you are running under this system you will need to follow other steps.</p><p>To install ATtiny Arduno Hardware Library follow these steps: (Steps referenced by <a href="http://highlowtech.org/?p=1695" target="_blank">these tutorial</a>)</p><ol><li>Unzip the attiny master.zip file. It should contain an “attiny-master” folder that contains an “attiny” folder.</li><li>Locate your Arduino sketchbook folder (you can find its location in the preferences dialog in the Arduino software)</li><li>Create a new sub-folder called “hardware” in the sketchbook folder, if it doesn’t exist already.</li><li>Copy the “attiny” folder (not the attiny-master folder) from the unzipped ATtiny master.zip to the “hardware” folder. You should end up with folder structure like Documents > Arduino > hardware > attiny that contains the file boards.txt and another folder called variants.</li></ol></section><!-- Bootloader the ATiny --><section><h2>Arduino 1.0 into ATtiny</h2><p>Steps to programming the micro controller with Arduino:<ol><li>Connect the ISP programmer with your Hello board using your ISP connector cable. I am using Fab ISP programmer.</li><li>With the USB cable conect ISP programmer to your computer and open your Arduino IDE.</li><li>Go to <code>Tools > Board menu</code> and select <code>ATtiny44 (20 Mhz Clock)</code></li><li>Next, go to <code>Tools > Programmer menu</code> and select <code>USBtinyISP</code></li><li>To finish and send the bootloader to the micro controller go to <code>Tools</code> and select <code>Burn Bootloader</code></li></ol></p><div class="row"><div class="col-lg-8 col-md-8 col-xs-12 thumb"><div class="thumbnail"><img class="img-responsive" src="images/w8/s1.jpg"></div></div><div class="col-lg-8 col-md-8 col-xs-12 thumb"><div class="thumbnail"><img class="img-responsive" src="images/w8/s2.jpg"></div></div><div class="col-lg-8 col-md-8 col-xs-12 thumb"><div class="thumbnail"><img class="img-responsive" src="images/w8/s3.jpg"></div></div></div></section><!-- Programming --><section><h2>Programming the "hello RGB board"</h2><h4>ATtiny Pin Reference</h4><p>To know what <code>pin</code> correspond to each ATtiny Pin and which custom component (RGB led and button) and the "hello RGB board". Also it is necessary to reference the pin used the schemathics</p><!-- gallery --><div class="row"><div class="col-lg-9 col-md-9 col-xs-12 thumb"><div class="thumbnail"><img class="img-responsive" src="images/w8/ATinny44-Datasheet.jpg"></div></div><div class="col-lg-9 col-md-9 col-xs-12 thumb"><div class="thumbnail"><img class="img-responsive" src="images/w8/ATinny44-Pin.jpg"></div></div></div><h4>Simple Blink Test</h4><p>To test if my board is perfectly soldered and is working the simple way is upload an <code>led blink script example</code> on Arduino IDE.<ol><li>Make sure your ISP programmer and your board are connected together and to the computer. For the board is necesseary a <code>FTDI to USB cable.</code></li><li>Check that <code>Tools > Programmer > USBtinyISP</code> in the menu is select</li><li>Go to <code>Files > Examples > 01.Basics</code> and select <code>Blink</code></li><li>Change the <code>int led = 13;</code> value to corresponding pin number<code>int led = 7;</code></li><li><code>Upload your code</code> with the "upload button". (top-left corner on the IDE, side of check button)</li></ol></p><!-- gallery --><div class="row"><div class="col-lg-8 col-md-8 col-xs-12 thumb"><div class="thumbnail"><img class="img-responsive" src="images/w8/blink-1.jpg"></div></div></div><div class="row"><div class="col-lg-6 col-md-6 col-xs-12 thumb"><div class="thumbnail"><img class="img-responsive" src="images/w8/blink-2.jpg"></div></div><div class="col-lg-6 col-md-6 col-xs-12 thumb"><div class="thumbnail"><img class="img-responsive" src="images/w8/blink-3.jpg"></div></div></div><h4>Hello RGB board</h4><p>I try to use the <code>PWM~</code> pins to make a fade with the rgb colors and establish different states for the button when pressed. It will make change the color of the led depending on the state of the button.</p><!-- gallery --><div class="row"><div class="col-lg-6 col-md-6 col-xs-12 thumb"><div class="thumbnail"><img class="img-responsive" src="images/w8/RGB-1.png"></div></div><div class="col-lg-8 col-md-8 col-xs-12 thumb"><div class="thumbnail"><iframe width="100%" height="360" src="//www.youtube.com/embed/dt0eaguNo_Q?rel=0" frameborder="0" allowfullscreen></iframe><div style="font-size:14; margin-top:5px">NOTE: Hello RGB Board demostration is working without the FTDI cable.</div></div></div></div></section><section><h2>What I've learned</h2><p>FTDI serial communication is an alternative for the USB connectors. The tricky part is use the Serial Software to make possible to <code>debug</code>. When ready the configuration of communication ports you can start using Arduino IDE very normal.</p><h4>Comment Update</h4><p>It is very important to check your RX and TX connections since if the are not well the board won't transmit data via serial communications making impossible to do debugging processes.</p></section><!-- REFERENCES --><section><h2>References</h2><ol><li>ATtiny:<ul><li>Datasheet: <a href="http://academy.cba.mit.edu/classes/embedded_programming/doc8183.pdf" target="_blank">http://academy.cba.mit.edu/classes/embedded_programming/doc8183.pdf</a></li></ul></li><li>Arduino:<ul><li>Download Software: <a href="http://arduino.cc/es/main/software" target="_blank">http://arduino.cc/es/main/software</a></li><li>Reference: <a href="http://arduino.cc/en/Reference/HomePage" target="_blank">http://arduino.cc/en/Reference/HomePage</a></li><li>ATtiny hardware library:<a href="https://github.com/damellis/attiny/archive/master.zip" target="_blank">https://github.com/damellis/attiny/archive/master.zip</a></li></ul></li><li>Tutorials:<ul><li>How to program your ATtiny w/Arduino 1.0: <a href="http://highlowtech.org/?p=1695" target="_blank">http://highlowtech.org/?p=1695</a></li><li>Embedded programming: <a href="http://academy.cba.mit.edu/2012/labs/providence/tutorials/09.html" target="_blank">http://academy.cba.mit.edu/2012/labs/providence/tutorials/09.html</a></li></ul></li></ol></section><section><h2>Download Files</h2><p>You can download the code of the Hello RGB board here: <a href="https://github.com/vioklab/FabAcademy2014/tree/master/programming/helloRGB" target="_blank">https://github.com/vioklab/FabAcademy2014/tree/master/programming/helloRGB</a></p></section></div>